import{g as p,D as O}from"./Draggable-BIBO0-Gf.js";class V{constructor(){this.events={}}on(i,o){return this.events[i]||(this.events[i]=[]),this.events[i].push(o),{off:()=>this.off(i,o)}}off(i,o){this.events[i]&&(this.events[i]=this.events[i].filter(e=>e!==o))}emit(i,o=null){this.events[i]&&this.events[i].forEach(e=>e(o))}}function $(t,i,o){return{root:null,track:null,slides:[],mount(){this.root=t.container,this.track=this.root.querySelector(".tka-slider__track"),this.root.classList.add(`tka-slider--${t.options.type}`),this.collectSlides()},collectSlides(){this.slides=Array.from(this.track.children)}}}function P(t,i,o){return{x:0,slideWidth:0,mount(){this.calculate(),window.addEventListener("resize",()=>{this.calculate(),o.emit("resize")})},calculate(){const{Html:e}=i,{perView:n,gap:s}=t.options,a=e.root.offsetWidth;this.slideWidth=(a-s*(n-1))/n,e.slides.forEach(r=>{r.style.width=`${this.slideWidth}px`,r.style.marginRight=`${s}px`}),t.log(`Track calculated: slideWidth=${this.slideWidth}`)},getCoordinate(e){const{gap:n}=t.options;return e*(this.slideWidth+n)-this.getOffset()},getOffset(){const{focusAt:e,gap:n}=t.options,{Html:s}=i;return e==="center"?s.root.offsetWidth/2-this.slideWidth/2:typeof e=="number"?e*(this.slideWidth+n):0}}}function Y(t,i,o){return{tween:null,mount(){this.bind()},bind(){o.on("resize",()=>{this.to(t.state.index,{duration:0})})},to(e,n={}){const{Track:s,Html:a}=i,{animationDuration:r,animationEase:c,type:h}=t.options,d=n.duration!==void 0?n.duration:r/1e3,v=n.ease||c;if(this.tween&&this.tween.kill(),(h==="fade"||h==="fan")&&t.options.loop){const m=a.slides.length;e>=m&&(e=0),e<0&&(e=m-1)}if(t.state.index=e,t.state.animationDuration=d,h==="fade"||h==="fan"){o.emit("move",{x:0}),o.emit("move.after",{index:t.state.index});return}const M=s.getCoordinate(e);this.tween=p.to(a.track,{x:-M,duration:d,ease:v,onUpdate:()=>{o.emit("move",{x:p.getProperty(a.track,"x")})},onComplete:()=>{t.state.animationDuration=0;let m=!1;t.options.loop&&(m=this.loop(t.state.index)),m||o.emit("move.after",{index:t.state.index})}})},loop(e){const{Track:n,Html:s}=i,a=t.clonesCount||0,r=s.slides.length-a*2,c=.001;return e<a-c?(this.jump(e+r),!0):e>r+a-1+c?(this.jump(e-r),!0):!1},jump(e){const{Track:n,Html:s}=i,{type:a}=t.options;if(t.state.index=e,a==="fade"||a==="fan"){o.emit("move",{x:0,jump:!0}),o.emit("move.after",{index:e});return}const r=n.getCoordinate(e);p.set(s.track,{x:-r}),o.emit("move",{x:-r,jump:!0}),o.emit("move.after",{index:e})}}}function B(t,i,o){return{draggable:null,mount(){this.init()},init(){p.registerPlugin(O);const{Html:e,Move:n}=i,s=t.options.type==="fan",a=t.options.type==="fade";this.draggable=O.create(e.track,{type:s?"x,y":"x",trigger:e.root,edgeResistance:.65,inertia:!0,onDragStart:()=>{t.state.isDragging=!0,n.tween&&n.tween.kill(),o.emit("drag.start")},onDrag:function(){const r=t.options.swipeThreshold||80;if(a||s){if(Math.sqrt(this.x*this.x+this.y*this.y)>r*3){this.endDrag();return}p.set(e.track,{x:0,y:0}),o.emit("drag",{x:this.x,y:this.y});return}o.emit("drag",{x:this.x})},onDragEnd:function(){if(t.state.isDragging=!1,a||s){p.set(e.track,{x:0,y:0});const v=t.options.swipeThreshold||80;Math.sqrt(this.x*this.x+this.y*this.y)>v?s?this.x>0?n.to(t.state.index-1):n.to(t.state.index+1):this.getDirection()==="left"?n.to(t.state.index+1):this.getDirection()==="right"&&n.to(t.state.index-1):o.emit("move",{x:0}),o.emit("drag.end");return}const r=this.x,c=Track.slideWidth+t.options.gap,h=Track.getOffset();let d=Math.round((h-r)/c);t.options.loop||(d=Math.max(0,Math.min(d,e.slides.length-1))),n.to(d)}})[0]},disable(){this.draggable&&this.draggable.disable()},enable(){this.draggable&&this.draggable.enable()}}}function F(t,i,o){return{items:[],mount(){t.options.loop&&t.options.type!=="fade"&&t.options.type!=="fan"?this.run():t.clonesCount=0},remove(){const{Html:e}=i;e.track.querySelectorAll(".tka-slider__slide--clone").forEach(n=>n.remove()),e.collectSlides()},run(){this.remove();const{Html:e}=i,{perView:n,breakpoints:s}=t.options;let a=n;s&&Object.values(s).forEach(d=>{d.perView>a&&(a=d.perView)});const r=Math.ceil(a),c=e.slides;t.clonesCount=r;const h=c.slice(0,r).map(d=>d.cloneNode(!0));c.slice(-r).map(d=>d.cloneNode(!0)).reverse().forEach(d=>{d.classList.add("tka-slider__slide--clone"),e.track.insertBefore(d,e.track.firstChild)}),h.forEach(d=>{d.classList.add("tka-slider__slide--clone"),e.track.appendChild(d)}),i.Html.collectSlides(),i.Track.calculate(),t.state.index+=r,t.log(`Cloned ${r} slides on each side.`)}}}function N(t,i,o){return{mount(){this.bind(),this.update()},bind(){o.on("move.after",()=>{this.update()})},update(){const{Html:e}=i,{index:n}=t.state;e.slides.forEach((s,a)=>{a===n?s.classList.contains("is-active")||(s.classList.add("is-active"),o.emit("slide.active",{index:a,slide:s})):s.classList.contains("is-active")&&(s.classList.remove("is-active"),o.emit("slide.inactive",{index:a,slide:s}))})}}}function X(t,i,o){return{interval:null,mount(){t.options.autoplay&&(this.start(),this.bind())},bind(){const{Html:e}=i;t.options.hoverPause&&(e.root.addEventListener("mouseenter",()=>this.stop()),e.root.addEventListener("mouseleave",()=>this.start())),o.on("drag.start",()=>this.stop()),o.on("drag.end",()=>{t.options.autoplay&&this.start()})},start(){t.options.autoplay&&(this.stop(),this.interval=setInterval(()=>{const{Move:e}=i;e.to(t.state.index+1)},typeof t.options.autoplay=="number"?t.options.autoplay:3e3))},stop(){this.interval&&(clearInterval(this.interval),this.interval=null)}}}function G(t,i,o){return{prevItems:[],nextItems:[],mount(){this.bind()},bind(){const{Html:e}=i;e.root.querySelectorAll("[data-tka-control]").forEach(n=>{const s=n.getAttribute("data-tka-control");n.addEventListener("click",a=>{a.preventDefault(),this.move(s)}),s==="<"&&this.prevItems.push(n),s===">"&&this.nextItems.push(n)})},move(e){const{Move:n}=i,{index:s}=t.state;if(e===">")n.to(s+1);else if(e==="<")n.to(s-1);else if(e.startsWith("=")){const a=parseInt(e.substring(1));n.to(a)}}}}function U(t,i,o){return{wrapper:null,items:[],mount(){this.bind(),this.render()},bind(){o.on("move.after",()=>{this.active()}),o.on("mount.after",()=>{this.render()})},render(){const{Html:e}=i,{perView:n,loop:s}=t.options;if(this.wrapper=e.root.querySelector("[data-tka-bullets]"),!this.wrapper)return;this.wrapper.innerHTML="",this.items=[];const a=s?e.slides.length-t.clonesCount*2:e.slides.length;for(let r=0;r<a;r++){const c=document.createElement("button");c.className="tka-bullet",c.setAttribute("data-tka-bullet",r),c.addEventListener("click",h=>{h.preventDefault();const d=s?r+t.clonesCount:r;i.Move.to(d)}),this.wrapper.appendChild(c),this.items.push(c)}this.active()},active(){if(!this.wrapper)return;const{loop:e}=t.options,{index:n}=t.state;let s=n;if(e){const a=i.Html.slides.length-t.clonesCount*2;s=(n-t.clonesCount)%a,s<0&&(s+=a)}this.items.forEach((a,r)=>{r===s?a.classList.add("is-active"):a.classList.remove("is-active")})}}}function Z(t,i,o){return{isRevealed:!1,mount(){this.bind();const{type:e,revealOnMount:n}=t.options;n?(this.isRevealed=!0,setTimeout(()=>this.reveal(),50)):(this.isRevealed=!1,setTimeout(()=>{this.update(p.getProperty(i.Html.track,"x"),!0)},10))},reveal(){const{type:e}=t.options;if(this.isRevealed=!0,e==="fan"){this.update(0,!0);const n=i.Html.slides.map(s=>s.querySelector(".demo-slide")).filter(Boolean);p.from(n,{y:100,rotation:0,opacity:0,scale:.9,duration:.8,stagger:.1,ease:"back.out(1.2)",onComplete:()=>this.update(0,!0)})}else this.update(p.getProperty(i.Html.track,"x"),!0)},bind(){o.on("move",({x:e,jump:n})=>{this.update(e,n)}),o.on("drag",({x:e,y:n})=>{this.update(e,!1,n)}),o.on("resize",()=>{this.update(p.getProperty(i.Html.track,"x"),!0)})},update(e,n=!1,s=0){const{Html:a,Track:r}=i,{type:c,scaleOnCenter:h,scaleAmount:d,scaleRange:v,gap:M,animationEase:m}=t.options,D=r.slideWidth+M,_=n?0:t.state.animationDuration||0;a.slides.forEach((k,w)=>{const A=k.querySelector(".demo-slide");if(!A)return;let y,E,u=w-t.state.index;const x=a.slides.length;t.options.loop&&(c==="fade"||c==="fan")&&(u=(w-t.state.index)%x,u>x/2&&(u-=x),u<-x/2&&(u+=x));const S=Math.abs(u);if(c==="fade"||c==="fan")y=S,E=u;else{const g=r.getCoordinate(w),C=e+g;y=Math.abs(C)/D,E=C/D}let f=1;if(h){const g=v||1;f=1-Math.min(y,g)/g*(1-d),f=Math.max(d,Math.min(1,f))}const l={overwrite:!0};if(c==="coverflow")l.rotationY=E*-30,l.z=y*-100,l.opacity=this.isRevealed?1-Math.min(y,2)*.2:0,l.scale=f;else if(c==="fade"||c==="fan"){if(c==="fade")l.opacity=this.isRevealed?Math.max(0,1-S):0,l.scale=f,l.z=0,l.x=0,l.y=0,l.rotation=0;else if(c==="fan"){const g=t.options.rotateFactor||15,C=t.options.scaleFactor||.1,R=t.options.fanTranslateY||5,L=t.options.fanSpace||160,T=t.options.fanTilt||15,W=t.options.fanTranslateZ||-100,z=t.options.activeRotation||0,q=t.options.activeScale!==void 0?t.options.activeScale:1,I=t.options.activeTranslateY||0;if(u===0)l.rotation=(t.state.isDragging?e/15:0)+z,l.rotationY=t.state.isDragging?e/8:0,l.rotationX=t.state.isDragging?-s/8:0,l.x=e,l.y=s+I,l.opacity=this.isRevealed?1:0,l.scale=q,l.z=150;else if(S===1){const H=u===1,b=t.state.isDragging?.2:0;l.scale=1-C,l.y=R+s*b,l.opacity=this.isRevealed?.9:0,l.z=W,l.rotationX=-5+s/20*b,l.x=(H?L:-L)+e*b,l.rotation=(H?g:-g)+e/10*b,l.rotationY=(H?T:-T)+e/20*b}else l.opacity=0,l.z=-300,l.scale=.5,l.x=(u>0?1:-1)*300,l.y=0;l.ease=t.options.fanEase||"power2.out",k.style.zIndex=u===0?20:10-S}}else l.scale=f,l.opacity=this.isRevealed?h&&f<1?.6:1:0,l.rotationY=0,l.z=0,l.rotation=0,l.x=0,l.y=0;w===t.state.index?k.classList.add("is-active"):k.classList.remove("is-active"),l.duration=_,l.ease||(l.ease=m),n?p.set(A,l):p.to(A,l)})}}}function J(t,i,o){return{originalOptions:null,mount(){this.originalOptions=Object.assign({},t.options),this.bind(),this.check()},bind(){window.addEventListener("resize",()=>{this.check()})},check(){const{breakpoints:e}=this.originalOptions;if(!e||Object.keys(e).length===0)return;const n=window.innerWidth;let s=null;const a=Object.keys(e).map(Number).sort((c,h)=>h-c);for(const c of a)n<=c&&(s=e[c]);const r=s?Object.assign({},this.originalOptions,s):this.originalOptions;(r.perView!==t.options.perView||r.gap!==t.options.gap||r.focusAt!==t.options.focusAt)&&this.apply(r)},apply(e){t.log("Applying breakpoint options:",e),t.options=Object.assign(t.options,e),i.Track&&i.Track.calculate(),i.Clones,i.Move&&i.Move.jump(t.state.index),o.emit("breakpoint.change",e)}}}function K(t,i,o){return{mount(){this.applyLabels(),t.options.keyboard&&this.bind()},bind(){const{Html:e}=i;e.root.setAttribute("tabindex","0"),e.root.addEventListener("keydown",n=>{const{Move:s}=i;n.key==="ArrowRight"?s.to(t.state.index+1):n.key==="ArrowLeft"&&s.to(t.state.index-1)})},applyLabels(){const{Html:e}=i,{loop:n}=t.options,s=t.clonesCount||0;e.root.setAttribute("role","region"),e.root.setAttribute("aria-label","Image Slider"),e.track.setAttribute("role","list"),e.slides.forEach((a,r)=>{let c=r;if(n){const h=e.slides.length-s*2;c=(r-s)%h,c<0&&(c+=h)}a.setAttribute("role","listitem"),a.setAttribute("aria-label",`Slide ${c+1}`)}),o.on("move.after",({index:a})=>{e.slides.forEach((r,c)=>{c===a?r.setAttribute("aria-hidden","false"):r.setAttribute("aria-hidden","true")})})}}}function Q(t,i,o){return{el:null,mount(){if(!t.options.pagination)return;const{Html:e}=i;this.el=typeof t.options.pagination=="string"?e.root.querySelector(t.options.pagination):e.root.querySelector("[data-tka-pagination]"),this.el&&(this.bind(),this.update())},bind(){o.on("move.after",()=>this.update())},update(){if(!this.el)return;const{Html:e}=i,{perView:n,loop:s}=t.options,a=s?e.slides.length-t.clonesCount*2:e.slides.length;let r=t.state.index;s&&(r=(t.state.index-t.clonesCount)%a,r<0&&(r+=a)),this.el.innerText=`${r+1} / ${a}`}}}const tt={Html:$,Track:P,Move:Y,Drag:B,Clones:F,Classes:N,Autoplay:X,Controls:G,Bullets:U,Effects:Z,Breakpoints:J,A11y:K,Pagination:Q};class j{constructor(i,o={}){this.selector=i,this.options=Object.assign(j.defaults,o),this.events=new V,this.state={index:0,isDragging:!1,animationDuration:0},this.clonesCount=0,this.components={},this.init()}static get defaults(){return{startAt:0,perView:1,focusAt:0,gap:0,loop:!1,autoplay:!1,hoverPause:!0,type:"slide",animationDuration:600,animationEase:"power2.out",pagination:!1,keyboard:!0,scaleGradual:!1,rotateFactor:15,scaleFactor:.1,fanTranslateY:5,fanSpace:160,activeRotation:0,activeScale:1,activeTranslateY:0,breakpoints:{},swipeThreshold:80,debug:!1,revealOnMount:!0}}init(){if(this.log("Initializing slider..."),this.container=typeof this.selector=="string"?document.querySelector(this.selector):this.selector,!this.container){console.error(`[TkaSlider] Container not found: ${this.selector}`);return}if(this.container.tka_slider)return this.log("Slider already attached to this element. Returning existing instance."),this.container.tka_slider;this.container.tka_slider=this,this.log("Slider initialized.")}log(...i){this.options.debug&&console.log("[TkaSlider]",...i)}mount(){if(this._isMounted)return this.log("Slider already mounted. Skipping."),this;this.events.emit("mount.before"),this._components=Object.assign({},tt,this.options.components);for(const i in this._components)typeof this._components[i]=="function"&&(this.components[i]=this._components[i](this,this.components,this.events));for(const i in this.components)this.components[i].mount&&this.components[i].mount();if(this._isMounted=!0,this.events.emit("mount.after"),this.components.Move){const i=this.options.startAt+(this.options.loop&&this.clonesCount||0);this.components.Move.jump(i)}return this}register(i){return this.options.components=Object.assign({},this.options.components,i),this}on(i,o){return this.events.on(i,o)}reveal(){return this.components.Effects&&this.components.Effects.reveal&&this.components.Effects.reveal(),this}}export{j as R};
