import{g as d,D as O}from"./Draggable-BIBO0-Gf.js";class ${constructor(){this.events={}}on(o,s){return this.events[o]||(this.events[o]=[]),this.events[o].push(s),{off:()=>this.off(o,s)}}off(o,s){this.events[o]&&(this.events[o]=this.events[o].filter(p=>p!==s))}emit(o,s=null){this.events[o]&&this.events[o].forEach(p=>p(s))}}function V(t,o,s){return{root:null,track:null,slides:[],mount(){this.root=t.container,this.track=this.root.querySelector(".tka-slider__track"),this.root.classList.add(`tka-slider--${t.options.type}`),this.collectSlides()},collectSlides(){this.slides=Array.from(this.track.children)}}}function B(t,o,s){return{x:0,slideWidth:0,mount(){this.calculate(),window.addEventListener("resize",()=>{this.calculate(),s.emit("resize")})},calculate(){const{Html:e}=o,{perView:n,gap:i}=t.options,a=e.root.offsetWidth;this.slideWidth=(a-i*(n-1))/n,e.slides.forEach(r=>{r.style.width=`${this.slideWidth}px`,r.style.marginRight=`${i}px`}),t.log(`Track calculated: slideWidth=${this.slideWidth}`)},getCoordinate(e){const{gap:n}=t.options;return e*(this.slideWidth+n)-this.getOffset()},getOffset(){const{focusAt:e,gap:n}=t.options,{Html:i}=o;return e==="center"?i.root.offsetWidth/2-this.slideWidth/2:typeof e=="number"?e*(this.slideWidth+n):0}}}function F(t,o,s){return{tween:null,mount(){this.bind()},bind(){s.on("resize",()=>{this.to(t.state.index,{duration:0})})},to(e,n={}){const{Track:i,Html:a}=o,{animationDuration:r,animationEase:l,type:h}=t.options,f=n.duration!==void 0?n.duration:r/1e3,u=n.ease||l;if(this.tween&&this.tween.kill(),(h==="fade"||h==="fan")&&t.options.loop){const g=a.slides.length;e>=g&&(e=0),e<0&&(e=g-1)}if(t.state.index=e,t.state.animationDuration=f,h==="fade"||h==="fan"){s.emit("move",{x:0}),s.emit("move.after",{index:t.state.index});return}const w=i.getCoordinate(e);this.tween=d.to(a.track,{x:-w,duration:f,ease:u,onUpdate:()=>{s.emit("move",{x:d.getProperty(a.track,"x")})},onComplete:()=>{t.state.animationDuration=0;let g=!1;t.options.loop&&(g=this.loop(t.state.index)),g||s.emit("move.after",{index:t.state.index})}})},loop(e){const{Track:n,Html:i}=o,a=t.clonesCount||0,l=i.slides.length-a*2,h=.001;return e<a-h?(this.jump(e+l),!0):e>l+a-1+h?(this.jump(e-l),!0):!1},jump(e){const{Track:n,Html:i}=o,{type:a}=t.options;if(t.state.index=e,a==="fade"||a==="fan"){s.emit("move",{x:0,jump:!0}),s.emit("move.after",{index:e});return}const r=n.getCoordinate(e);d.set(i.track,{x:-r}),s.emit("move",{x:-r,jump:!0}),s.emit("move.after",{index:e})}}}function Y(t,o,s){return{draggable:null,mount(){this.init()},init(){d.registerPlugin(O);const{Html:e,Move:n}=o,i=t.options.type==="fan",a=t.options.type==="fade";this.draggable=O.create(e.track,{type:i?"x,y":"x",trigger:e.root,edgeResistance:.65,inertia:!0,onDragStart:()=>{t.state.isDragging=!0,n.tween&&n.tween.kill(),s.emit("drag.start")},onDrag:function(){const r=t.options.swipeThreshold||80;if(a||i){if(Math.sqrt(this.x*this.x+this.y*this.y)>r*3){this.endDrag();return}d.set(e.track,{x:0,y:0}),s.emit("drag",{x:this.x,y:this.y});return}s.emit("drag",{x:this.x})},onDragEnd:function(){if(t.state.isDragging=!1,a||i){d.set(e.track,{x:0,y:0});const u=t.options.swipeThreshold||80;Math.sqrt(this.x*this.x+this.y*this.y)>u?i?this.x>0?n.to(t.state.index-1):n.to(t.state.index+1):this.getDirection()==="left"?n.to(t.state.index+1):this.getDirection()==="right"&&n.to(t.state.index-1):s.emit("move",{x:0}),s.emit("drag.end");return}const r=this.x,l=Track.slideWidth+t.options.gap,h=Track.getOffset();let f=Math.round((h-r)/l);t.options.loop||(f=Math.max(0,Math.min(f,e.slides.length-1))),n.to(f)}})[0]},disable(){this.draggable&&this.draggable.disable()},enable(){this.draggable&&this.draggable.enable()}}}function N(t,o,s){return{items:[],mount(){t.options.loop&&t.options.type!=="fade"&&t.options.type!=="fan"?this.run():t.clonesCount=0},remove(){const{Html:e}=o;e.track.querySelectorAll(".tka-slider__slide--clone").forEach(i=>i.remove()),e.collectSlides()},run(){this.remove();const{Html:e}=o,{perView:n,breakpoints:i}=t.options;let a=n;i&&Object.values(i).forEach(u=>{u.perView>a&&(a=u.perView)});const r=Math.ceil(a),l=e.slides;t.clonesCount=r;const h=l.slice(0,r).map(u=>u.cloneNode(!0));l.slice(-r).map(u=>u.cloneNode(!0)).reverse().forEach(u=>{u.classList.add("tka-slider__slide--clone"),e.track.insertBefore(u,e.track.firstChild)}),h.forEach(u=>{u.classList.add("tka-slider__slide--clone"),e.track.appendChild(u)}),o.Html.collectSlides(),o.Track.calculate(),t.state.index+=r,t.log(`Cloned ${r} slides on each side.`)}}}function G(t,o,s){return{mount(){this.bind(),this.update()},bind(){s.on("move.after",()=>{this.update()})},update(){const{Html:e}=o,{index:n}=t.state;e.slides.forEach((i,a)=>{a===n?i.classList.contains("is-active")||(i.classList.add("is-active"),s.emit("slide.active",{index:a,slide:i})):i.classList.contains("is-active")&&(i.classList.remove("is-active"),s.emit("slide.inactive",{index:a,slide:i}))})}}}function Z(t,o,s){return{interval:null,mount(){t.options.autoplay&&(this.start(),this.bind())},bind(){const{Html:e}=o;t.options.hoverPause&&(e.root.addEventListener("mouseenter",()=>this.stop()),e.root.addEventListener("mouseleave",()=>this.start())),s.on("drag.start",()=>this.stop()),s.on("drag.end",()=>{t.options.autoplay&&this.start()})},start(){t.options.autoplay&&(this.stop(),this.interval=setInterval(()=>{const{Move:e}=o;e.to(t.state.index+1)},typeof t.options.autoplay=="number"?t.options.autoplay:3e3))},stop(){this.interval&&(clearInterval(this.interval),this.interval=null)}}}function K(t,o,s){return{prevItems:[],nextItems:[],mount(){this.bind()},bind(){const{Html:e}=o;e.root.querySelectorAll("[data-tka-control]").forEach(i=>{const a=i.getAttribute("data-tka-control");i.addEventListener("click",r=>{r.preventDefault(),this.move(a)}),a==="<"&&this.prevItems.push(i),a===">"&&this.nextItems.push(i)})},move(e){const{Move:n}=o,{index:i}=t.state;if(e===">")n.to(i+1);else if(e==="<")n.to(i-1);else if(e.startsWith("=")){let a=parseInt(e.substring(1));t.options.loop&&t.options.type==="slide"&&(a+=t.clonesCount||0),n.to(a)}}}}function U(t,o,s){return{wrapper:null,items:[],mount(){this.bind(),this.render()},bind(){s.on("move.after",()=>{this.active()}),s.on("mount.after",()=>{this.render()})},render(){const{Html:e}=o,{perView:n,loop:i}=t.options;if(this.wrapper=e.root.querySelector("[data-tka-bullets]"),!this.wrapper)return;this.wrapper.innerHTML="",this.items=[];const a=i?e.slides.length-t.clonesCount*2:e.slides.length;for(let r=0;r<a;r++){const l=document.createElement("button");l.className="tka-bullet",l.setAttribute("data-tka-bullet",r),l.addEventListener("click",h=>{h.preventDefault();const f=i?r+t.clonesCount:r;o.Move.to(f)}),this.wrapper.appendChild(l),this.items.push(l)}this.active()},active(){if(!this.wrapper)return;const{loop:e}=t.options,{index:n}=t.state;let i=n;if(e){const a=o.Html.slides.length-t.clonesCount*2;i=(n-t.clonesCount)%a,i<0&&(i+=a)}this.items.forEach((a,r)=>{r===i?a.classList.add("is-active"):a.classList.remove("is-active")})}}}function J(t,o,s){return{isRevealed:!1,mount(){this.bind();const{type:e,revealOnMount:n}=t.options;n?(this.isRevealed=!0,setTimeout(()=>this.reveal(),50)):(this.isRevealed=!1,setTimeout(()=>{this.update(d.getProperty(o.Html.track,"x"),!0)},10))},reveal(){const{type:e}=t.options;if(this.isRevealed=!0,e==="fan"){this.update(0,!0);const n=o.Html.slides.map(i=>i.querySelector(".demo-slide")).filter(Boolean);d.from(n,{y:100,rotation:0,opacity:0,scale:.9,duration:.8,stagger:.1,ease:"back.out(1.2)",onComplete:()=>this.update(0,!0)})}else this.update(d.getProperty(o.Html.track,"x"),!0)},bind(){s.on("move",({x:e,jump:n})=>{this.update(e,n)}),s.on("drag",({x:e,y:n})=>{this.update(e,!1,n)}),s.on("resize",()=>{this.update(d.getProperty(o.Html.track,"x"),!0)})},update(e,n=!1,i=0){const{Html:a,Track:r}=o,{type:l,scaleOnCenter:h,scaleAmount:f,scaleRange:u,gap:w,animationEase:g}=t.options,H=r.slideWidth+w,j=n?0:t.state.animationDuration||0;a.slides.forEach((S,T)=>{const A=S.querySelector(".demo-slide");if(!A)return;let b,D,m=T-t.state.index;const x=a.slides.length;t.options.loop&&(l==="fade"||l==="fan")&&(m=(T-t.state.index)%x,m>x/2&&(m-=x),m<-x/2&&(m+=x));const E=Math.abs(m);if(l==="fade"||l==="fan")b=E,D=m;else{const y=r.getCoordinate(T),M=e+y;b=Math.abs(M)/H,D=M/H}let v=1;if(h){const y=u||1;v=1-Math.min(b,y)/y*(1-f),v=Math.max(f,Math.min(1,v))}const c={overwrite:!0};if(l==="coverflow")c.rotationY=D*-30,c.z=b*-100,c.opacity=this.isRevealed?1-Math.min(b,2)*.2:0,c.scale=v;else if(l==="fade"||l==="fan"){if(l==="fade")c.opacity=this.isRevealed?Math.max(0,1-E):0,c.scale=v,c.z=0,c.x=0,c.y=0,c.rotation=0;else if(l==="fan"){const y=t.options.rotateFactor||15,M=t.options.scaleFactor||.1,I=t.options.fanTranslateY||5,W=t.options.fanSpace||160,L=t.options.fanTilt||15,_=t.options.fanTranslateZ||-100,z=t.options.activeRotation||0,P=t.options.activeScale!==void 0?t.options.activeScale:1,q=t.options.activeTranslateY||0;if(m===0)c.rotation=(t.state.isDragging?e/15:0)+z,c.rotationY=t.state.isDragging?e/8:0,c.rotationX=t.state.isDragging?-i/8:0,c.x=e,c.y=i+q,c.opacity=this.isRevealed?1:0,c.scale=P,c.z=150;else if(E===1){const C=m===1,k=t.state.isDragging?.2:0;c.scale=1-M,c.y=I+i*k,c.opacity=this.isRevealed?.9:0,c.z=_,c.rotationX=-5+i/20*k,c.x=(C?W:-W)+e*k,c.rotation=(C?y:-y)+e/10*k,c.rotationY=(C?L:-L)+e/20*k}else c.opacity=0,c.z=-300,c.scale=.5,c.x=(m>0?1:-1)*300,c.y=0;c.ease=t.options.fanEase||"power2.out",S.style.zIndex=m===0?20:10-E}}else c.scale=v,c.opacity=this.isRevealed?h&&v<1?.6:1:0,c.rotationY=0,c.z=0,c.rotation=0,c.x=0,c.y=0;T===t.state.index?S.classList.add("is-active"):S.classList.remove("is-active"),c.duration=j,c.ease||(c.ease=g),n?d.set(A,c):d.to(A,c)})}}}function Q(t,o,s){return{originalOptions:null,mount(){this.originalOptions=Object.assign({},t.options),this.bind(),this.check()},bind(){window.addEventListener("resize",()=>{this.check()})},check(){const{breakpoints:e}=this.originalOptions;if(!e||Object.keys(e).length===0)return;const n=window.innerWidth;let i=null;const a=Object.keys(e).map(Number).sort((l,h)=>h-l);for(const l of a)n<=l&&(i=e[l]);const r=i?Object.assign({},this.originalOptions,i):this.originalOptions;(r.perView!==t.options.perView||r.gap!==t.options.gap||r.focusAt!==t.options.focusAt)&&this.apply(r)},apply(e){t.log("Applying breakpoint options:",e),t.options=Object.assign(t.options,e),o.Track&&o.Track.calculate(),o.Clones,o.Move&&o.Move.jump(t.state.index),s.emit("breakpoint.change",e)}}}function X(t,o,s){return{mount(){this.applyLabels(),t.options.keyboard&&this.bind()},bind(){const{Html:e}=o;e.root.setAttribute("tabindex","0"),e.root.addEventListener("keydown",n=>{const{Move:i}=o;n.key==="ArrowRight"?i.to(t.state.index+1):n.key==="ArrowLeft"&&i.to(t.state.index-1)})},applyLabels(){const{Html:e}=o,{loop:n}=t.options,i=t.clonesCount||0;e.root.setAttribute("role","region"),e.root.setAttribute("aria-label","Image Slider"),e.track.setAttribute("role","list"),e.slides.forEach((a,r)=>{let l=r;if(n){const h=e.slides.length-i*2;l=(r-i)%h,l<0&&(l+=h)}a.setAttribute("role","listitem"),a.setAttribute("aria-label",`Slide ${l+1}`)}),s.on("move.after",({index:a})=>{e.slides.forEach((r,l)=>{l===a?r.setAttribute("aria-hidden","false"):r.setAttribute("aria-hidden","true")})})}}}function tt(t,o,s){return{el:null,mount(){if(!t.options.pagination)return;const{Html:e}=o;this.el=typeof t.options.pagination=="string"?e.root.querySelector(t.options.pagination):e.root.querySelector("[data-tka-pagination]"),this.el&&(this.bind(),this.update())},bind(){s.on("move.after",()=>this.update())},update(){if(!this.el)return;const{Html:e}=o,{perView:n,loop:i}=t.options,a=i?e.slides.length-t.clonesCount*2:e.slides.length;let r=t.state.index;i&&(r=(t.state.index-t.clonesCount)%a,r<0&&(r+=a)),this.el.innerText=`${r+1} / ${a}`}}}const et={Html:V,Track:B,Move:F,Drag:Y,Clones:N,Classes:G,Autoplay:Z,Controls:K,Bullets:U,Effects:J,Breakpoints:Q,A11y:X,Pagination:tt};class R{constructor(o,s={}){this.selector=o,this.options=Object.assign(R.defaults,s),this.events=new $,this.state={index:0,isDragging:!1,animationDuration:0},this.clonesCount=0,this.components={},this.init()}static get defaults(){return{startAt:0,perView:1,focusAt:0,gap:0,loop:!1,autoplay:!1,hoverPause:!0,type:"slide",animationDuration:600,animationEase:"power2.out",pagination:!1,keyboard:!0,scaleGradual:!1,rotateFactor:15,scaleFactor:.1,fanTranslateY:5,fanSpace:160,activeRotation:0,activeScale:1,activeTranslateY:0,breakpoints:{},swipeThreshold:80,debug:!1,revealOnMount:!0}}init(){if(this.log("Initializing slider..."),this.container=typeof this.selector=="string"?document.querySelector(this.selector):this.selector,!this.container){console.error(`[TkaSlider] Container not found: ${this.selector}`);return}if(this.container.tka_slider)return this.log("Slider already attached to this element. Returning existing instance."),this.container.tka_slider;this.container.tka_slider=this,this.log("Slider initialized.")}log(...o){this.options.debug&&console.log("[TkaSlider]",...o)}mount(){if(this._isMounted)return this.log("Slider already mounted. Skipping."),this;this.events.emit("mount.before"),this._components=Object.assign({},et,this.options.components);for(const o in this._components)typeof this._components[o]=="function"&&(this.components[o]=this._components[o](this,this.components,this.events));for(const o in this.components)this.components[o].mount&&this.components[o].mount();if(this._isMounted=!0,this.events.emit("mount.after"),this.components.Move){const o=this.options.startAt+(this.options.loop&&this.clonesCount||0);this.components.Move.jump(o)}return this}register(o){return this.options.components=Object.assign({},this.options.components,o),this}on(o,s){return this.events.on(o,s)}reveal(){return this.components.Effects&&this.components.Effects.reveal&&this.components.Effects.reveal(),this}go(o){if(this.components.Controls){const s=typeof o=="number"?`=${o}`:o;this.components.Controls.move(s)}return this}jump(o){let s=o;return this.options.loop&&this.options.type==="slide"&&(s+=this.clonesCount||0),this.components.Move&&this.components.Move.jump(s),this}}export{R as S};
